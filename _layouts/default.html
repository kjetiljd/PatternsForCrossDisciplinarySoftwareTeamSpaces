<!DOCTYPE html>
<html lang="{{ site.lang | default: "en-US" }}">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{{ '/assets/css/style.css?v=' | append: site.github.build_revision | relative_url }}">
    {% include head-custom.html %}
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-CRHTQJZJBY');
    </script>
</head>

<body>
<header>
    <div class="container">
        <a id="a-title" href="{{ '/' | relative_url }}">
            <h1>{{ site.title | default: site.github.repository_name }}</h1>
        </a>
        <h2>{{ site.description | default: site.github.project_tagline }}</h2>

        <section id="downloads">
            {% if site.show_downloads %}
            <a href="{{ site.github.zip_url }}" class="btn">Download as .zip</a>
            <a href="{{ site.github.tar_url }}" class="btn">Download as .tar.gz</a>
            {% endif %}
            <a href="{{ site.github.repository_url }}" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
    </div>
</header>

<div class="container">
    <section id="main_content">
        {{ content }}
    </section>
</div>

<script type="module">
    Array.from(document.getElementsByClassName("language-mermaid")).forEach(element => {
        element.classList.add("mermaid");
    });
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });

    // Mermaid fullscreen overlay logic
    document.addEventListener('DOMContentLoaded', () => {
        function createOverlay(svgContent) {
            const overlay = document.createElement('div');
            overlay.style.position = 'fixed';
            overlay.style.top = 0;
            overlay.style.left = 0;
            overlay.style.width = '100vw';
            overlay.style.height = '100vh';
            overlay.style.background = 'rgba(255,255,255,0.97)'; // More white, more opaque
            overlay.style.display = 'flex';
            overlay.style.alignItems = 'center';
            overlay.style.justifyContent = 'center';
            overlay.style.zIndex = 9999;
            overlay.style.cursor = 'zoom-out';
            overlay.tabIndex = -1;

            const container = document.createElement('div');
            container.style.width = '100vw';
            container.style.height = '100vh';
            container.style.display = 'flex';
            container.style.alignItems = 'center';
            container.style.justifyContent = 'center';
            container.style.overflow = 'auto';
            container.style.background = 'transparent';
            container.style.padding = '0';
            container.style.borderRadius = '0';
            container.innerHTML = svgContent;

            // Make SVG responsive and large
            const svg = container.querySelector('svg');
            if (svg) {
                svg.style.width = '90vw';
                svg.style.height = '90vh';
                svg.style.maxWidth = 'none';
                svg.style.maxHeight = 'none';
                svg.style.display = 'block';
            }

            overlay.appendChild(container);

            function closeOverlay() {
                document.body.removeChild(overlay);
                document.removeEventListener('keydown', escListener);
            }

            function escListener(e) {
                if (e.key === 'Escape') closeOverlay();
            }

            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) closeOverlay();
            });
            document.addEventListener('keydown', escListener);

            document.body.appendChild(overlay);
            overlay.focus();
        }

        document.querySelectorAll('.mermaid').forEach(el => {
            el.style.cursor = 'zoom-in';
            el.addEventListener('click', () => {
                // Find the rendered SVG inside the mermaid element
                const svg = el.querySelector('svg');
                if (svg) {
                    createOverlay(svg.outerHTML);
                }
            });
        });
    });
</script>
</body>
</html>

